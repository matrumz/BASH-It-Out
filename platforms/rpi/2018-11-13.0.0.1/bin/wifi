#!/usr/bin/env bash
set -e

die() {
    printf 'ERROR: %s\n' "$1" >&2
    exit 1
}
warn() {
    printf 'WARN: %s\n' "$1" >&2
}
restart() {
    dhclient -r wlan0
    ifdown wlan0
    ifup wlan0
    dhclient -v wlan0
}

doRestart=0

while (( "$#" )); do
    case $1 in
        -r)
            doRestart=1
            ;;
        -*)
            warn "Unknown option (ignored): $1"
            ;;
    esac
    shift
done

if [ $doRestart = 1 ]; then
    restart
fi
